0.70330+0i  0.0496+0.3697i  0.0496-0.3697i
[4,] 0.5029+0i -0.74239+0i -0.32651+0i -0.2262+0.1063i -0.2262-0.1063i
[5,] 0.4839+0i  0.48539+0i -0.53901+0i -0.3375-0.1752i -0.3375+0.1752i

> svd(A)
$d
[1] 29.929  6.943  6.668  3.960  1.707

$u
        [,1]     [,2]    [,3]       [,4]     [,5]
[1,] -0.4659 -0.04141 -0.8795  8.440e-02  0.02379
[2,] -0.3931  0.15031  0.2249  1.824e-05  0.87881
[3,] -0.3811  0.62205  0.2170  5.570e-01 -0.33239
[4,] -0.5166  0.14296  0.1852 -7.659e-01 -0.30290
[5,] -0.4652 -0.75386  0.3073  3.097e-01 -0.15780

$v
        [,1]    [,2]     [,3]    [,4]    [,5]
[1,] -0.4831 -0.3264  0.47567 -0.1955  0.6289
[2,] -0.3627  0.3731  0.53450  0.5920 -0.3051
[3,] -0.3995  0.4779 -0.59210  0.2252  0.4590
[4,] -0.3983 -0.6985 -0.36298  0.3821 -0.2752
[5,] -0.5628  0.1948 -0.07549 -0.6439 -0.4743

> La.svd(A)
$d
[1] 29.929  6.943  6.668  3.960  1.707

$u
        [,1]     [,2]    [,3]       [,4]     [,5]
[1,] -0.4659 -0.04141 -0.8795  8.440e-02  0.02379
[2,] -0.3931  0.15031  0.2249  1.824e-05  0.87881
[3,] -0.3811  0.62205  0.2170  5.570e-01 -0.33239
[4,] -0.5166  0.14296  0.1852 -7.659e-01 -0.30290
[5,] -0.4652 -0.75386  0.3073  3.097e-01 -0.15780

$vt
        [,1]    [,2]    [,3]    [,4]     [,5]
[1,] -0.4831 -0.3627 -0.3995 -0.3983 -0.56284
[2,] -0.3264  0.3731  0.4779 -0.6985  0.19477
[3,]  0.4757  0.5345 -0.5921 -0.3630 -0.07549
[4,] -0.1955  0.5920  0.2252  0.3821 -0.64390
[5,]  0.6289 -0.3051  0.4590 -0.2752 -0.47430

> 
> As <- crossprod(A)
> E <- eigen(As)
> E$values
[1] 895.737  48.201  44.468  15.678   2.915
> abs(E$vectors) # signs vary
       [,1]   [,2]    [,3]   [,4]   [,5]
[1,] 0.4831 0.3264 0.47567 0.1955 0.6289
[2,] 0.3627 0.3731 0.53450 0.5920 0.3051
[3,] 0.3995 0.4779 0.59210 0.2252 0.4590
[4,] 0.3983 0.6985 0.36298 0.3821 0.2752
[5,] 0.5628 0.1948 0.07549 0.6439 0.4743
> chol(As)
      [,1]   [,2]   [,3]   [,4]   [,5]
[1,] 15.03 10.643 10.177 11.574 15.965
[2,]  0.00  5.452  3.243 -2.052  1.667
[3,]  0.00  0.000  7.543  3.428  4.920
[4,]  0.00  0.000  0.000  4.907 -1.269
[5,]  0.00  0.000  0.000  0.000  3.088
> backsolve(As, 1:5)
[1] -0.009040 -0.005129 -0.006246  0.004158  0.017065
> 
> ##  -------  tests of logical matrices -----------------
> 
> set.seed(123)
> A <- matrix(runif(25) > 0.5, 5, 5)
> 
> A %*% A
     [,1] [,2] [,3] [,4] [,5]
[1,]    2    2    2    1    3
[2,]    2    1    1    2    3
[3,]    2    2    1    1    3
[4,]    2    2    2    2    4
[5,]    2    1    2    2    3
> crossprod(A)
     [,1] [,2] [,3] [,4] [,5]
[1,]    3    2    1    1    3
[2,]    2    3    2    0    3
[3,]    1    2    3    1    3
[4,]    1    0    1    2    2
[5,]    3    3    3    2    5
> tcrossprod(A)
     [,1] [,2] [,3] [,4] [,5]
[1,]    3    1    2    2    2
[2,]    1    3    2    3    2
[3,]    2    2    3    3    1
[4,]    2    3    3    4    2
[5,]    2    2    1    2    3
> 
> Q <- qr(A)
> zapsmall(Q$qr)
        [,1]    [,2]    [,3]    [,4]    [,5]
[1,] -1.7321 -1.1547 -0.5774 -0.5774 -1.7321
[2,]  0.5774 -1.2910 -1.0328  0.5164 -0.7746
[3,]  0.0000  0.7746 -1.2649 -0.9487 -0.9487
[4,]  0.5774  0.2582  0.0508  0.7071  0.7071
[5,]  0.5774 -0.5164 -0.6803 -0.3136  0.0000
> zapsmall(Q$qraux)
[1] 1.000 1.258 1.731 1.950 0.000
> determinant(A, log = FALSE) # 0
$modulus
[1] 0
attr(,"logarithm")
[1] FALSE

$sign
[1] 1

attr(,"class")
[1] "det"
> 
> rcond(A)
[1] 0
> rcond(A, "I")
[1] 0
> rcond(A, "1")
[1] 0
> 
> E <- eigen(A)
> zapsmall(E$values)
[1]  3.163+0.000i  0.271+0.908i  0.271-0.908i -0.705+0.000i  0.000+0.000i
> zapsmall(Mod(E$vectors))
       [,1]   [,2]   [,3]   [,4]   [,5]
[1,] 0.4358 0.3604 0.3604 0.6113 0.0000
[2,] 0.4087 0.4495 0.4495 0.3771 0.5774
[3,] 0.3962 0.5870 0.5870 0.2028 0.0000
[4,] 0.5340 0.2792 0.2792 0.6649 0.5774
[5,] 0.4483 0.4955 0.4955 0.0314 0.5774
> S <- svd(A)
> zapsmall(S$d)
[1] 3.379 1.536 1.414 0.472 0.000
> S <- La.svd(A)
> zapsmall(S$d)
[1] 3.379 1.536 1.414 0.472 0.000
> 
> As <- A
> As[upper.tri(A)] <- t(A)[upper.tri(A)]
> det(As)
[1] 2
> E <- eigen(As)
> E$values
[1]  3.465  1.510  0.300 -1.000 -1.275
> zapsmall(E$vectors)
        [,1]    [,2]    [,3] [,4]    [,5]
[1,] -0.4023  0.2877  0.3638  0.5  0.6108
[2,] -0.5338 -0.3474  0.5742 -0.5 -0.1207
[3,] -0.4177 -0.5380 -0.6384  0.0  0.3585
[4,] -0.4959  0.0733 -0.1273  0.5 -0.6946
[5,] -0.3644  0.7084 -0.3378 -0.5  0.0369
> solve(As)
     [,1] [,2] [,3] [,4] [,5]
[1,]    0    1 -1.0  0.0  0.0
[2,]    1    1 -1.0  0.0 -1.0
[3,]   -1   -1  1.5  0.5  0.5
[4,]    0    0  0.5 -0.5  0.5
[5,]    0   -1  0.5  0.5  0.5
> 
> ## quite hard to 